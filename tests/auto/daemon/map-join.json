[
  {
    "name": "John",
    "_type": "Person"
  },
  {
    "name": "Robert",
    "_type": "Person"
  },
  {
    "name": "Ben",
    "_type": "Person"
  },
  {
    "name": "Sam",
    "_type": "Person"
  },
  {
    "name": "Frank",
    "_type": "Person"
  },
  {
    "name": "Steve",
    "_type": "Person"
  },
  {
    "name": "Gary",
    "_type": "Person"
  },
  {
    "name": "Bruce",
    "_type": "Person"
  },
  {
    "name": "Paul",
    "_type": "Person"
  },
  {
    "name": "George",
    "_type": "Person"
  },
  {
    "_type": "_schemaType",
    "name": "FoafPerson",
    "schema": {
      "_type": "object",
      "extends": "View",
      "properties": {
         "value" : {
           "type": "object",
           "properties": {
             "friend": {
               "type": "string",
               "indexed": true
             }
           }
         }
      }
    }
  },
  {
    "_type": "Map",
    "sourceType": "Person",
    "targetType": "FoafPerson",
    "map": " \
      function map(p, context) { \
        if (!context) { \
          if ((p.friend === undefined) || (p.friend === null)) \
            jsondb.emitViewObject(p.name, { friend: null }); \
          else \
            jsondb.lookupWithType('_uuid', p.friend, 'Person', { person: p }); \ 
        } else { \
          jsondb.emitViewObject(context.person.name, { friend: context.person.friend, foaf: p.friend }); \
        } \
     }"
  }
]
